function m(){tPB=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,tPB),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),gl.STATIC_DRAW),tPB.itemSize=2,tPB.numItems=6;var e="precision highp float;uniform float ti;uniform vec2 res;float v=.001;float n(vec3 v){return max(max(v.r,v.g),v.b);}vec3 n(inout vec3 v,vec3 r){vec3 m=floor((v+r*.5)/r);v=mod(v+r*.5,r)-r*.5;return m;}float s(inout float v,float r){float m=r*.5,f=floor((v+m)/r);if(v>=0.)v=mod(v+m,r)-m;return f;}float t(vec3 v,float r){return length(v)-r;}float x(vec3 v,vec3 r){vec3 m=abs(v)-r;return length(max(m,vec3(0)))+n(min(m,vec3(0)));}mat3 s(float v){return mat3(1,0,0,0,cos(v),-sin(v),0,sin(v),cos(v));}mat3 t(float v){return mat3(cos(v),0,sin(v),0,1,0,-sin(v),0,cos(v));}mat3 x(float v){return mat3(cos(v),-sin(v),0,sin(v),cos(v),0,0,0,1);}float c(vec3 v){float m;vec3 r=v;r*=s(ti*.1);r*=x(ti*.1);float f=x(r,vec3(.2)),c=t(r,.25),g=max(f,-c);vec3 i=r;i+=vec3(0.,0.,ti);float e=s(i.b,.2);i*=s(e);i*=t(e+3.);i*=x(e+5.);float d=x(i,vec3(-max(-.05,r.b)));v-=vec3(ti,0.,0.);v*=s(ti*.1);v*=t(ti*.1);v+=vec3(1.5);n(v,vec3(3.+.2*sin(ti)));m=t(v,1.);m=min(m,g);m=min(m,d);return m;}void c(inout vec3 f,vec3 e,out vec3 i){float g=0.,t=v;for(int d=0;d<128;d++){t=c(f);g+=t;f+=t*e;if(t<v||g>32.)break;}if(t<v){vec2 d=vec2(0.,v);i=normalize(vec3(c(f+d.grr)-c(f-d.grr),c(f+d.rgr)-c(f-d.rgr),c(f+d.rrg)-c(f-d.rrg)));}else i=vec3(0.);}void main(){vec3 v=vec3(2.,0.,0.),m=vec3(0.,0.,0.),r=vec3(0.,1.,0.),t=normalize(m-v),i=normalize(cross(r,v)),d=cross(t,i);vec2 e=-1.+2.*gl_FragCoord.rg/res.rg;e.r*=res.r/res.g;vec3 g=normalize(i*e.r+d*e.g+t),s=v,b,n=vec3(0.);for(int l=0;l<3;l++){c(s,g,b);float x,o;x=max(0.,dot(-g,b));o=pow(x,32.);n+=vec3(x+o-float(l)+.3);vec3 a=vec3(0.);float u=distance(s,a);x=max(0.,dot(normalize(a-s),b));o=pow(x,32.);float z=1./(1.+.1*u+.01*u*u);n.r+=.3*(z*(x+o));n.g+=.1*(z*(x+o));s-=g*.1;g=reflect(g,b);}n=.1+n*.7;vec2 x=gl_FragCoord.rg/res.rg-vec2(.5);vec4 l=vec4(1.,1.,1.,1.);gl_FragColor=vec4(n*exp(-4.*(x.r*x.r+x.g*x.g)),1.);}",r="attribute vec3 aVP;void main(void){gl_Position=vec4(aVP,1.0);}",t=gS(gl,e,"f"),i=gS(gl,r,"v");sP=gl.createProgram(),gl.attachShader(sP,i),gl.attachShader(sP,t),gl.linkProgram(sP),gl.useProgram(sP),sP.vPA=gl.getAttribLocation(sP,"aVP"),gl.enableVertexAttribArray(sP.vPA),k()}function k(){window.requestAnimationFrame(k),d()}function d(){gl.viewport(0,0,gl.viewportWidth,gl.viewportHeight),58e3>t&&(t=(new Date).getTime()-t0,gl.uniform1f(gl.getUniformLocation(sP,"ti"),.001*t),gl.viewportWidth=c.width,gl.viewportHeight=c.height,gl.uniform2f(gl.getUniformLocation(sP,"res"),gl.viewportWidth,gl.viewportHeight),gl.bindBuffer(gl.ARRAY_BUFFER,tPB),gl.vertexAttribPointer(sP.vPA,tPB.itemSize,gl.FLOAT,!1,0,0),gl.drawArrays(gl.TRIANGLES,0,6))}function gS(e,r,t){var i;if("f"==t)i=e.createShader(e.FRAGMENT_SHADER);else{i=e.createShader(e.VERTEX_SHADER)}return e.shaderSource(i,r),e.compileShader(i),i}var t0=(new Date).getTime(),t=1,gl,tPB,sP,c=document.createElement("canvas");document.body.appendChild(c),gl=c.getContext("experimental-webgl"),function(){function e(){c.width=window.innerWidth,c.height=window.innerHeight,m()}window.addEventListener("resize",e,!1),e()}();
walther2016